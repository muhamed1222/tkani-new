# üìã –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Bottom Sheets

## üì¶ –¢–∏–ø—ã Bottom Sheets

–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –µ—Å—Ç—å 4 —Ç–∏–ø–∞ bottom sheets —Å —Ä–∞–∑–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º:

### 1. `openBottomSheet` - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Bottom Sheet
**–§–∞–π–ª:** `lib/core/helpers/open_bottom_sheet.dart`

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ (`barrierColor: Colors.black`)
- ‚úÖ –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ 100% (fullscreen)
- ‚úÖ Snap sizes: 20%, 50%, 100%
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```dart
openBottomSheet(
  context,
  (scrollController) => AboutRespublicWidget(scrollController: scrollController),
);
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- –û —Ä–µ—Å–ø—É–±–ª–∏–∫–µ (About Republic)
- –í—ã–±–æ—Ä —Ä–µ—Å–ø—É–±–ª–∏–∫–∏ (Republic Selection)
- –ú–∞—Ä—à—Ä—É—Ç—ã (Routes)
- –ú–µ—Å—Ç–∞ (Places)

---

### 2. `openBottomSheet50` - Bottom Sheet —Å —Ç–µ–º–Ω—ã–º —Ñ–æ–Ω–æ–º
**–§–∞–π–ª:** `lib/core/helpers/open_bottom_sheet50.dart`

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚úÖ –û—á–µ–Ω—å —Ç–µ–º–Ω—ã–π —Ñ–æ–Ω (`barrierColor: Colors.black.withOpacity(0.9)`)
- ‚úÖ –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ 100% (fullscreen)
- ‚úÖ Snap sizes: 20%, 50%, 100%
- ‚úÖ –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```dart
openBottomSheet50(
  context,
  (scrollController) => FavouritesWidget(scrollController: scrollController),
);
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- –ò–∑–±—Ä–∞–Ω–Ω–æ–µ (Favourites)

---

### 3. `openBottomSheetDynamic` - Bottom Sheet —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ–º
**–§–∞–π–ª:** `lib/core/helpers/open_bottom_sheet_dynamic.dart`

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- ‚ú® **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ** –ø—Ä–∏ —Å–∂–∞—Ç–∏–∏/—Ä–∞—Å–∫—Ä—ã—Ç–∏–∏
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –Ω–∞ 100% (fullscreen)
- ‚úÖ Snap sizes: 20%, 50%, 100%
- üé® **–§–æ–Ω —Å–≤–µ—Ç–ª–µ–µ—Ç –ø—Ä–∏ —Å–∂–∞—Ç–∏–∏** –æ—Ç 100% –¥–æ 20% —á–µ—Ä–Ω–æ–≥–æ

**–î–∏–Ω–∞–º–∏–∫–∞ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏—è:**
| –†–∞—Å–∫—Ä—ã—Ç–∏–µ sheet | Opacity —Ñ–æ–Ω–∞ | –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç |
|-----------------|--------------|-------------------|
| 100% (–æ—Ç–∫—Ä—ã—Ç–∏–µ) | 1.0 (100%) | ‚¨õ **–ü–æ–ª–Ω–æ—Å—Ç—å—é —á–µ—Ä–Ω—ã–π** |
| 75% | 0.75 (75%) | üåëüåë –¢–µ–º–Ω–µ–µ |
| 50% | 0.5 (50%) | üåë –°—Ä–µ–¥–Ω–µ –∑–∞—Ç–µ–º–Ω–µ–Ω |
| 20% | 0.2 (20%) | üåë –°–ª–µ–≥–∫–∞ –∑–∞—Ç–µ–º–Ω–µ–Ω |

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```dart
openBottomSheetDynamic(
  context,
  (scrollController) => PlacesMainWidget(scrollController: scrollController),
);
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- –ú–∞—Ä—à—Ä—É—Ç—ã (Routes)
- –ú–µ—Å—Ç–∞ (Places)
- –ü—Ä–æ—Ñ–∏–ª—å (Profile)
- –≠–∫—Ä–∞–Ω—ã, –≥–¥–µ –≤–∞–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ñ–æ–Ω

---

## üéØ –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø?

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `openBottomSheet` –µ—Å–ª–∏:
- ‚úÖ –ù—É–∂–µ–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ–Ω —Å —á–µ—Ä–Ω—ã–º –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ–º
- ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π
- ‚úÖ –ù–µ –Ω—É–∂–Ω–∞ –¥–∏–Ω–∞–º–∏–∫–∞

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `openBottomSheet50` –µ—Å–ª–∏:
- ‚úÖ –ù—É–∂–µ–Ω —Ç–µ–º–Ω—ã–π —Ñ–æ–Ω (0.9 opacity)
- ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- ‚úÖ –°—Ç–∞—Ç–∏—á–Ω–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `openBottomSheetDynamic` –µ—Å–ª–∏:
- ‚úÖ –ù—É–∂–µ–Ω **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ñ–æ–Ω**, –∫–æ—Ç–æ—Ä—ã–π —Å–≤–µ—Ç–ª–µ–µ—Ç –ø—Ä–∏ —Å–∂–∞—Ç–∏–∏
- ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–∫–∏, –∫–∞—Ä—Ç–æ—á–∫–∏, —Ñ–∏–ª—å—Ç—Ä—ã (–ú–µ—Å—Ç–∞, –ú–∞—Ä—à—Ä—É—Ç—ã, –ü—Ä–æ—Ñ–∏–ª—å)
- ‚úÖ –≠–∫—Ä–∞–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –Ω–∞ 100%

---

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

`openBottomSheetDynamic` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
1. **NotificationListener<DraggableScrollableNotification>** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å–∫—Ä—ã—Ç–∏—è
2. **AnimatedContainer** - –ø–ª–∞–≤–Ω–æ –∞–Ω–∏–º–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ —Ñ–æ–Ω–∞
3. **–ö–∞—Å—Ç–æ–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `_calculateBackdropOpacity()`** - –≤—ã—á–∏—Å–ª—è–µ—Ç opacity –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç extent

```dart
double _calculateBackdropOpacity() {
  if (_sheetExtent <= 0.2) {
    return 0.3;
  } else if (_sheetExtent <= 0.5) {
    // –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É 0.3 –∏ 0.6
    return 0.3 + (_sheetExtent - 0.2) / 0.3 * 0.3;
  } else {
    // –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É 0.6 –∏ 0.9
    return 0.6 + (_sheetExtent - 0.5) / 0.5 * 0.3;
  }
}
```

### –ü—Ä–∏–º–µ—Ä —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏—è, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç:

```dart
Future<T?> openBottomSheetCustomDynamic<T>(
  BuildContext context,
  Widget Function(ScrollController) childBuilder, {
  double minOpacity = 0.3,
  double maxOpacity = 0.9,
  double initialChildSize = 0.5,
}) {
  // –ö–∞—Å—Ç–æ–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
}
```

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–ø–∏—Å–∫–∞ –º–µ—Å—Ç —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ–º

```dart
ElevatedButton(
  onPressed: () {
    openBottomSheetDynamic(
      context,
      (scrollController) => PlacesMainWidget(
        scrollController: scrollController,
      ),
    );
  },
  child: Text('–û—Ç–∫—Ä—ã—Ç—å –º–µ—Å—Ç–∞'),
)
```

### –ü—Ä–∏–º–µ—Ä 2: –û—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ–º

```dart
IconButton(
  onPressed: () {
    openBottomSheetDynamic(
      context,
      (scrollController) => ProfilePage(),
    );
  },
  icon: Icon(Icons.person),
)
```

### –ü—Ä–∏–º–µ—Ä 3: –û—Ç–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ—Å–ø—É–±–ª–∏–∫–µ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ–º

```dart
TextButton(
  onPressed: () {
    openBottomSheet(
      context,
      (scrollController) => AboutRespublicWidget(
        scrollController: scrollController,
      ),
    );
  },
  child: Text('–û —Ä–µ—Å–ø—É–±–ª–∏–∫–µ'),
)
```

---

## üé® UX Best Practices

### 1. –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏—è
- **–¢–µ–º–Ω—ã–π —Ñ–æ–Ω (0.9)** - –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π** - –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π** - –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤

### 2. Snap sizes
–í—Å–µ bottom sheets –∏—Å–ø–æ–ª—å–∑—É—é—Ç snap sizes: `[0.2, 0.5, 1.0]`
- **20%** - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ —Ä–∞—Å–∫—Ä—ã—Ç—ã–π (preview)
- **50%** - —Å—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä (–∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä)
- **100%** - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞—Å–∫—Ä—ã—Ç—ã–π (fullscreen)

### 3. Smooth corners
–í—Å–µ bottom sheets –∏—Å–ø–æ–ª—å–∑—É—é—Ç `SmoothBorderClipper` —Å radius 20 –¥–ª—è –ø–ª–∞–≤–Ω—ã—Ö —Å–∫—Ä—É–≥–ª–µ–Ω–∏–π.

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

### –ò–∑ —Å—Ç–∞—Ä–æ–≥–æ API –≤ –Ω–æ–≤—ã–π

**–ë—ã–ª–æ:**
```dart
showModalBottomSheet(
  context: context,
  builder: (context) => PlacesMainWidget(),
);
```

**–°—Ç–∞–ª–æ:**
```dart
openBottomSheetDynamic(
  context,
  (scrollController) => PlacesMainWidget(scrollController: scrollController),
);
```

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –§–æ–Ω –Ω–µ –∑–∞—Ç–µ–º–Ω—è–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø:
- `openBottomSheet` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ (black)
- `openBottomSheet50` - —Ç–µ–º–Ω–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ (0.9)
- `openBottomSheetDynamic` - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞: –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞—Ç–µ–º–Ω–µ–Ω–∏—è –¥–µ—Ä–≥–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `AnimatedContainer` –∏–º–µ–µ—Ç `duration: const Duration(milliseconds: 100)`

### –ü—Ä–æ–±–ª–µ–º–∞: Bottom sheet –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `Navigator.pop(context)` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 12 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0


